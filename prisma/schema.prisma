generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Lead {
  id              String       @id @default(cuid())
  fullName        String
  phoneNumber     String
  email           String?
  studentName     String?
  studentClass    String?
  targetExam      TargetExam
  source          LeadSource
  sourceLeadId    String?      @unique
  status          LeadStatus   @default(NEW)
  tags            String[]
  notes           String?
  lastContactedAt DateTime?
  createdAt       DateTime     @default(now())
  updatedAt       DateTime     @updatedAt
  calls           CallRecord[]
}

model CallRecord {
  id           String     @id @default(cuid())
  lead         Lead       @relation(fields: [leadId], references: [id], onDelete: Cascade)
  leadId       String
  direction    CallDirection
  recordingUrl String?
  transcript   String?
  disposition  CallDisposition @default(PENDING)
  outcomeNotes String?
  startedAt    DateTime        @default(now())
  endedAt      DateTime?
}

model AgentScript {
  id         String   @id @default(cuid())
  name       String   @unique
  persona    String
  greeting   String
  pitch      String
  objectionHandling String
  closing    String
  createdAt  DateTime @default(now())
  updatedAt  DateTime @updatedAt
}

enum TargetExam {
  SAINIK_SCHOOL
  RASHTRIYA_MILITARY_SCHOOL
  NAVODAYA
  OTHER
}

enum LeadSource {
  FACEBOOK
  GOOGLE_ADS
  INBOUND_CALL
  WEBSITE_FORM
  IMPORTED
  MANUAL
}

enum LeadStatus {
  NEW
  CONTACTED
  FOLLOW_UP
  DEMO_SCHEDULED
  DEMO_COMPLETED
  ENROLLED
  LOST
}

enum CallDirection {
  INBOUND
  OUTBOUND
}

enum CallDisposition {
  PENDING
  COMPLETED
  FAILED
  NO_ANSWER
}
